{"version":3,"sources":["uni-app:///main.js","webpack:///D:/git-projects/daguanjia/daguanjia-uniapp/daguanjia-uniapp/pages/setting.vue?ad70","webpack:///D:/git-projects/daguanjia/daguanjia-uniapp/daguanjia-uniapp/pages/setting.vue?0935","webpack:///D:/git-projects/daguanjia/daguanjia-uniapp/daguanjia-uniapp/pages/setting.vue?f6eb","webpack:///D:/git-projects/daguanjia/daguanjia-uniapp/daguanjia-uniapp/pages/setting.vue?1171","uni-app:///pages/setting.vue"],"names":["createPage","Page"],"mappings":"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","file":"pages/setting.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/setting.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./setting.vue?vue&type=template&id=26e40432&\"\nvar renderjs\nimport script from \"./setting.vue?vue&type=script&lang=js&\"\nexport * from \"./setting.vue?vue&type=script&lang=js&\"\nimport style0 from \"../static/styles/setting.scss?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../HBuilderX-alpha/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/setting.vue\"\nexport default component.exports","export * from \"-!../../../../../HBuilderX-alpha/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../HBuilderX-alpha/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../HBuilderX-alpha/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../HBuilderX-alpha/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../HBuilderX-alpha/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../HBuilderX-alpha/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./setting.vue?vue&type=template&id=26e40432&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../HBuilderX-alpha/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../HBuilderX-alpha/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../HBuilderX-alpha/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../HBuilderX-alpha/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../HBuilderX-alpha/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./setting.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../HBuilderX-alpha/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../HBuilderX-alpha/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../HBuilderX-alpha/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../HBuilderX-alpha/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../HBuilderX-alpha/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./setting.vue?vue&type=script&lang=js&\"","<template>\n\n  <view class=\"container\">\n    <view class=\"header\" :class=\"{'no-login': !user.isLogin}\" style=\"height: 174px;\">\n      <view class=\"main-container\" style=\"margin:0\">\n        <view class=\"user-section\" @tap=\"redirect('/pages/settings/user_info')\">\n          <view class=\"user\">\n            <view>\n              <image :src=\"user.avatarUrl\"></image>\n            </view>\n            <view class=\"user-info\">\n              <view style=\"font-size: 16px\">{{ user.name }}</view>\n              <view class=\"text-grey\">{{ sayHello }}</view>\n            </view>\n          </view>\n          <view class=\"bonus\">设置 ></view>\n        </view>\n        <view class=\"header-bottom\">\n          <view @tap=\"developing()\">\n            <view>\n              <image src=\"../static/images/003-pie-chart.png\"></image>\n            </view>\n            <view>统计报表</view>\n          </view>\n          <view @tap=\"developing()\">\n            <view>\n              <image src=\"../static/images/help_ic.png\"></image>\n            </view>\n            <view>使用帮助</view>\n          </view>\n          <view @tap=\"redirect('/pages/settings/role_info')\">\n            <view>\n              <image src=\"../static/images/user_role.png\"></image>\n            </view>\n            <view>角色说明</view>\n          </view>\n          <view @tap=\"toAgentPage()\">\n            <view>\n              <image src=\"../static/images/hand.png\"></image>\n            </view>\n            <view>合伙人计划</view>\n          </view>\n        </view>\n      </view>\n    </view>\n    <view class=\"login-message\" v-if=\" !user.isLogin \">\n      <view>\n        <button class=\"get-user-btn\" open-type=\"getUserInfo\" @getuserinfo=\"getUserInfo\">点击登录</button>\n        <view class=\"continue\" style=\"font-size: 14px; margin-top: 6px\">\n          登录后开启高效办公之旅\n        </view>\n      </view>\n    </view>\n    <view class=\"setting-container\" style=\"padding-bottom: 26rpx;\">\n      <i-cell-group>\n        <i-cell :title=\"priceTitle\" :label=\"priceLabel\" is-link :url=\"priceUrl\" :value=\"expiryDate\">\n        </i-cell>\n        <i-cell title=\"更换封面\" is-link url=\"/pages/settings/header\">\n        </i-cell>\n        <i-cell title=\"反馈与建议\" is-link @tap=\"redirect('/pages/settings/feedback')\">\n        </i-cell>\n        <i-cell title=\"关于铛铛办公\" is-link url=\"/pages/settings/about\" :value=\"version\">\n        </i-cell>\n      </i-cell-group>\n    </view>\n    <official-account style></official-account>\n    <view class=\"recommend-container\">\n      <button class=\"recommend-button\" open-type=\"share\">推荐给朋友使用</button>\n    </view>\n    <i-load-more i-class=\"bottom-text\" tip=\"铛铛办公\" loading=\"false\"></i-load-more>\n  </view>\n\n</template>\n\n<script>\nimport wxRequest from '@/utils/wxRequest';\nimport tip from '@/utils/tip';\nimport Session from '@/utils/session';\n\nexport default {\n  data() {\n    return {\n\n        tmplIds: {},\n        //需用户订阅的模版消息ID\n        system: '',\n        priceUrl: '',\n        user: {\n          name: '访客',\n          noRead: 0,\n          avatarUrl: '../static/images/no_login_avatar.png',\n          isLogin: true\n        },\n        version: '',\n        expiryDate: '',\n        priceLabel: '',\n        priceTitle: '服务到期时间',\n        showPrice: 'false',\n        isFree: 'false'\n\n    };\n  },\n\n  onLoad() {\n    wx.showShareMenu({\n      withShareTicket: true\n    });\n    this.system = Session.get('system');\n  },\n\n  onShow() {\n    this.getUser();\n  },\n\n  onShareAppMessage(ops) {\n    let url = '/pages/index';\n\n    if (this.user.isAgent) {\n      url = '/pages/index?fromUser=' + this.user.id;\n    }\n\n    return {\n      title: '当前最好用的会议室预约、车辆预约系统，无需安装即点即用',\n      path: url,\n      imageUrl: 'https://yzimg.jikebang.com/oa/share/share.png',\n      success: async function (res) {\n        tip.toast('感谢支持'); // await wxRequest.Post('settings/recommend', {\n        //   ticket: res['shareTickets'][0]\n        // })\n      }\n    };\n  },\n\n  mixins: [],\n  components: {},\n  props: {},\n  methods: {\n    redirect(url) {\n      this.subscribMsg();\n      uni.navigateTo({\n        url: url\n      });\n    },\n\n    toPricePage() {// if (this.showPrice == 'true') {\n      //   if (this.system.indexOf('iOS') > -1) {\n      //     tip.confirm('IOS暂不支持在线付费，如需付费购买，请联系客服处理，谢谢！', {}, '重要提示', false)\n      //   } else {\n      //     //  uni.navigateTo({\n      //     //   url: \"/pages/user/member_pay\"\n      //     // })          \n      //   }\n      // } else {\n      // }\n    },\n\n    toAgentPage() {\n      if (this.user.isAgent) {\n        uni.navigateTo({\n          url: \"/pages/agent/index\"\n        });\n      } else if (!this.user.isAgent && this.user.showAgent == \"true\") {\n        uni.navigateTo({\n          url: \"/pages/agent/welcome\"\n        });\n      } else {\n        tip.confirm('如欲代理此产品，请与客服联系，谢谢！', {}, '提示', false);\n      }\n    },\n\n    cleanSession() {\n      wx.clearStorage();\n      tip.toast('清理成功');\n    },\n\n    async getUserInfo(e) {\n      if (e.detail.errMsg != 'getUserInfo:ok') return false;\n      const userInfo = e.detail.userInfo;\n      const data = await wxRequest.Get('wx-login', userInfo);\n\n      if (data.result.bind) {\n        this.getUser(); //通知Tab页面需要刷新\n\n        for (let index = 0; index < 5; index++) {\n          Session.set('page-' + index, true);\n        }\n      } else {\n        //为绑定，转到绑定界面\n        uni.navigateTo({\n          url: '/pages/user/bind_user_form'\n        });\n      }\n    },\n\n    developing() {\n      wx.showToast({\n        title: '开发中，敬请期待',\n        icon: 'none'\n      });\n    },\n\n    async getUser() {\n      this.loadByCache();\n      const data = await wxRequest.Get('settings');\n\n      if (data.result.user) {\n        Session.set('user_load_cache', data.result.user);\n        this.user = data.result.user;\n        this.tmplIds = this.user.tmplIds;\n\n        if (!this.user.isDemo) {\n          this.expiryDate = data.result.user.expiryDate + \" 到期 \";\n\n          if (data.result.user.memberExpiry) {\n            this.expiryDate = \"服务已过期，请点击续费或联系客服\";\n          }\n        } else {\n          this.expiryDate = '';\n        }\n\n        this.showPrice = this.user.showPrice;\n        this.isFree = this.user.isFree;\n\n        if (this.showPrice == 'true') {\n          if (this.system.indexOf('iOS') > -1) {\n            this.priceUrl = '/pages/settings/contact';\n            this.priceLabel = '';\n            this.priceTitle = '服务到期时间';\n          } else {\n            this.priceUrl = '/pages/user/member_pay';\n            this.priceLabel = \"\";\n            this.priceTitle = \"续费升级\";\n          }\n        } else {\n          this.priceUrl = '/pages/settings/contact';\n          this.priceLabel = '';\n          this.priceTitle = '服务到期时间';\n        }\n\n        if (this.isFree || this.user.isDemo && this.user.isFreeVersion == \"true\") {\n          this.priceUrl = '';\n          this.priceLabel = '';\n          this.priceTitle = '版本类型';\n          this.expiryDate = '全功能免费版';\n        }\n      }\n\n      this.version = data.result.version;\n    },\n\n    async subscribMsg() {\n      if (this.user.isDemo) {\n        return;\n      }\n\n      let suggestAlerted = Session.get(\"suggestAlerted\");\n\n      if (suggestAlerted !== \"true\") {\n        await tip.confirm('尊敬的客户，稍后的消息订阅框，请您务必点击允许，并选择【总是保持以上选择】，以使本软件更好为您服务，谢谢！', {}, '重要提示', false);\n        Session.set(\"suggestAlerted\", \"true\");\n      }\n\n      if (this.tmplIds == null) {\n        return;\n      }\n\n      let subscribIds = [];\n      let subscribKeys = {};\n      subscribIds.push(this.tmplIds.wx_tmpl_id_suggest.id);\n      subscribKeys[this.tmplIds.wx_tmpl_id_suggest.id] = \"wx_tmpl_id_suggest\";\n      subscribIds.push(this.tmplIds.wx_tmpl_id_suggest_reply.id);\n      subscribKeys[this.tmplIds.wx_tmpl_id_suggest_reply.id] = \"wx_tmpl_id_suggest_reply\";\n      new Promise((resolve, reject) => {\n        wx.requestSubscribeMessage({\n          tmplIds: subscribIds,\n          success: res => {\n            let acceptKeys = [];\n            subscribIds.forEach(tmplId => {\n              if (res[tmplId] === 'accept') {\n                acceptKeys.push(subscribKeys[tmplId]);\n              }\n            });\n            resolve(acceptKeys);\n          },\n\n          fail(err) {\n            //失败\n            console.error(err);\n            reject();\n          }\n\n        });\n      }).then(res => {\n        this.updateTmplIds(res);\n      });\n    },\n\n    async updateTmplIds(acceptKeys) {\n      let tmpKeyStr = '';\n      acceptKeys.forEach(key => {\n        tmpKeyStr = tmpKeyStr + key + \",\";\n      });\n      const data = await wxRequest.Get('updateTmplIds', {\n        tmplIds: tmpKeyStr\n      });\n\n      if (data.code >= 1) {}\n    },\n\n    loadByCache() {\n      const cacheData = Session.get('user_load_cache');\n\n      if (cacheData) {\n        this.user = cacheData.user;\n        this.version = cacheData.version;\n      }\n    }\n\n  },\n  computed: {\n    sayHello() {\n      const now = new Date();\n      const hour = now.getHours();\n\n      if (hour < 6) {\n        return '凌晨好';\n      } else if (hour < 9) {\n        return '早上好';\n      } else if (hour < 12) {\n        return '上午好';\n      } else if (hour < 14) {\n        return '中午好';\n      } else if (hour < 17) {\n        return '下午好';\n      } else if (hour < 24) {\n        return '晚上好';\n      } else {\n        return '你好';\n      }\n    }\n\n  },\n  watch: {}\n};\n</script>\n<style lang=\"scss\" src=\"../static/styles/setting.scss\">\n\n\n\n</style>"],"sourceRoot":""}